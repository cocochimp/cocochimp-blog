(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-90c6cdc2"],{"1b3b":function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"d",(function(){return a})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return i})),n.d(e,"e",(function(){return l}));var r=n("b775");function o(t){return Object(r["a"])({url:"/content/article",method:"post",data:t})}function a(t){return Object(r["a"])({url:"/content/article/list",method:"get",params:t})}function c(t){return Object(r["a"])({url:"/content/article/"+t,method:"delete"})}function i(t){return Object(r["a"])({url:"/content/article/"+t,method:"get"})}function l(t){return Object(r["a"])({url:"/content/article",method:"put",data:t})}},"85c4":function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var r=n("b775");function o(t){var e=new FormData;return e.append("img",t),Object(r["a"])({url:"/upload",headers:{"Content-Type":"multipart/form-data"},method:"post",data:e})}},"90fa":function(t,e,n){"use strict";n.d(e,"f",(function(){return d})),n.d(e,"e",(function(){return m})),n.d(e,"d",(function(){return f})),n.d(e,"a",(function(){return p})),n.d(e,"g",(function(){return b})),n.d(e,"b",(function(){return h})),n.d(e,"c",(function(){return g}));var r=n("b775"),o=n("53ca"),a=(n("b64b"),n("fb6a"),n("d3b7"),n("ac1f"),n("1276"),n("3ca3"),n("ddb0"),n("2b3d"),n("9861"),n("caad"),n("2532"),n("bc3a")),c=n.n(a),i=n("5c96"),l=n("5f87");c.a.defaults.headers["Content-Type"]="application/json;charset=utf-8";var s=c.a.create({baseURL:"http://116.205.191.163:8989",responseType:"blob"});s.interceptors.request.use((function(t){var e=!1===(t.headers||{}).isToken;if(Object(l["a"])()&&!e&&(t.headers["token"]=Object(l["a"])()),"get"===t.method&&t.params){for(var n=t.url+"?",r=0,a=Object.keys(t.params);r<a.length;r++){var c=a[r],i=t.params[c],s=encodeURIComponent(c)+"=";if(null!==i&&"undefined"!==typeof i)if("object"===Object(o["a"])(i))for(var u=0,d=Object.keys(i);u<d.length;u++){var m=d[u];if(null!==i[m]&&"undefined"!==typeof i[m]){var f=c+"["+m+"]",p=encodeURIComponent(f)+"=";n+=p+encodeURIComponent(i[m])+"&"}}else n+=s+encodeURIComponent(i)+"&"}n=n.slice(0,-1),t.params={},t.url=n}return t}),(function(t){console.log(t),Promise.reject(t)})),s.interceptors.response.use((function(t){if(console.log(t),t.data){var e=new Blob([t.data]),n=t.headers["content-disposition"],r="test";n&&(r=window.decodeURI(t.headers["content-disposition"].split("=")[1],"UTF-8"));var o=window.URL.createObjectURL(e),a=document.createElement("a");a.style.display="none",a.href=o,a.setAttribute("download",r),document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(o)}}),(function(t){console.log("err"+t);var e=t.message;return"Network Error"===e?e="后端接口连接异常":e.includes("timeout")?e="系统接口请求超时":e.includes("Request failed with status code")&&(e="系统接口"+e.substr(e.length-3)+"异常"),Object(i["Message"])({message:e,type:"error",duration:5e3}),Promise.reject(t)}));var u=s;function d(t){return Object(r["a"])({url:"/content/category/list",method:"get",params:t})}function m(){return Object(r["a"])({url:"/content/category/listAllCategory",method:"get"})}function f(t){return Object(r["a"])({url:"/content/category/"+t,method:"get"})}function p(t){return Object(r["a"])({url:"/content/category",method:"post",data:t})}function b(t){return Object(r["a"])({url:"/content/category",method:"put",data:t})}function h(t){return Object(r["a"])({url:"/content/category/"+t,method:"delete"})}function g(){return u({url:"/content/category/export",method:"get"})}},"9dd4":function(t,e,n){"use strict";n.d(e,"e",(function(){return o})),n.d(e,"d",(function(){return a})),n.d(e,"c",(function(){return c})),n.d(e,"a",(function(){return i})),n.d(e,"f",(function(){return l})),n.d(e,"b",(function(){return s}));var r=n("b775");function o(t){return Object(r["a"])({url:"/content/tag/list",method:"get",params:t})}function a(){return Object(r["a"])({url:"/content/tag/listAllTag",method:"get"})}function c(t){return Object(r["a"])({url:"/content/tag/"+t,method:"get"})}function i(t){return Object(r["a"])({url:"/content/tag",method:"post",data:t})}function l(t){return Object(r["a"])({url:"/content/tag",method:"put",data:t})}function s(t){return Object(r["a"])({url:"/content/tag/"+t,method:"delete"})}},"9e33":function(t,e,n){"use strict";n("dd1f")},d6ce:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("el-form",{ref:"form",attrs:{model:t.form,"label-width":"90px"}},[n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"文章标题",prop:"title"}},[n("el-input",{attrs:{placeholder:"请输入文章标题",maxlength:"30"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1)],1),n("el-col",{attrs:{span:6}},[n("el-form-item",{attrs:{label:"分类"}},[n("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.categoryId,callback:function(e){t.$set(t.form,"categoryId",e)},expression:"form.categoryId"}},t._l(t.categoryList,(function(t){return n("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)],1),n("el-col",{attrs:{span:6}},[n("el-form-item",{attrs:{label:"标签"}},[n("el-select",{attrs:{placeholder:"请选择",multiple:""},model:{value:t.form.tags,callback:function(e){t.$set(t.form,"tags",e)},expression:"form.tags"}},t._l(t.tagList,(function(t){return n("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})})),1)],1)],1)],1),n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"文章摘要"}},[n("el-input",{attrs:{type:"textarea"},model:{value:t.form.summary,callback:function(e){t.$set(t.form,"summary",e)},expression:"form.summary"}})],1)],1),n("el-col",{attrs:{span:6}},[n("el-form-item",{attrs:{label:"允许评论"}},[n("el-radio-group",{model:{value:t.form.isComment,callback:function(e){t.$set(t.form,"isComment",e)},expression:"form.isComment"}},[n("el-radio",{key:"0",attrs:{label:"0"}},[t._v("正常")]),n("el-radio",{key:"1",attrs:{label:"1"}},[t._v("停用")])],1)],1)],1),n("el-col",{attrs:{span:6}},[n("el-form-item",{attrs:{label:"是否置顶"}},[n("el-radio-group",{model:{value:t.form.isTop,callback:function(e){t.$set(t.form,"isTop",e)},expression:"form.isTop"}},[n("el-radio",{key:"0",attrs:{label:"0"}},[t._v("是")]),n("el-radio",{key:"1",attrs:{label:"1"}},[t._v("否")])],1)],1)],1)],1),n("el-row",{attrs:{gutter:20}}),n("el-row",{attrs:{gutter:20}},[n("el-col",{attrs:{span:12}},[n("el-form-item",{attrs:{label:"缩略图"}},[n("el-upload",{staticClass:"upload-demo",attrs:{"file-list":t.fileList,"list-type":"picture",drag:"",name:"img",action:"upload","on-remove":t.fileRemove,limit:1,"http-request":t.handleUpload,"on-exceed":t.onExceed}},[n("i",{staticClass:"el-icon-upload"}),n("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),n("em",[t._v("点击上传")])]),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过500kb")])])],1)],1),n("el-col",{attrs:{span:12}},[n("el-form-item",[n("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.handleSubmit}},[t._v(t._s(t.aId?"更新":"发布"))])],1),n("el-form-item",[t.aId?t._e():n("el-button",{attrs:{type:"info"},on:{click:t.handleSave}},[t._v("保存到草稿箱")])],1)],1)],1),n("el-row",[n("mavon-editor",{ref:"md",on:{imgAdd:t.addImg},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1)],1)],1)},o=[],a=(n("b0c0"),n("90fa")),c=n("85c4"),i=n("1b3b"),l=n("9dd4"),s={name:"Write",data:function(){return{form:{title:"",thumbnail:"",isTop:"1",isComment:"0",content:""},categoryList:[],tagList:[],aId:-1,fileList:[]}},watch:{$route:{handler:function(t){this.aId=t.query&&t.query.id,console.log(this.aId)},immediate:!0}},created:function(){this.getCategoryAndTag(),this.aId&&this.getArticle()},methods:{getArticle:function(){var t=this;Object(i["c"])(this.aId).then((function(e){t.form=e,t.fileList.push({name:"缩略图",url:e.thumbnail})}))},handleSave:function(){var t=this;this.form.status="1",Object(i["a"])(this.form).then((function(e){t.$modal.msgSuccess("保存草稿成功")}))},handleSubmit:function(){var t=this;this.aId?Object(i["e"])(this.form).then((function(e){t.$modal.msgSuccess("博客更新成功"),t.$router.push({path:"/content/article"})})):(this.form.status="0",Object(i["a"])(this.form).then((function(e){t.$modal.msgSuccess("博客发布成功"),t.$router.push({path:"/content/article"})})))},onExceed:function(){this.$message.error("只能上传一个图片")},handleUpload:function(t){var e=this;Object(c["a"])(t.file).then((function(n){e.form.thumbnail=n,e.fileList.push({name:t.file.name,url:n})})).catch((function(t){e.$message.error(t.msg)}))},fileRemove:function(t,e){this.fileList.pop()},addImg:function(t,e){var n=this;Object(c["a"])(e).then((function(e){n.$refs.md.$img2Url(t,e)})).catch((function(t){n.$message.error(t.msg)}))},getCategoryAndTag:function(){var t=this;Object(a["e"])().then((function(e){t.categoryList=e})),Object(l["d"])().then((function(e){t.tagList=e}))},beforeAvatarUpload:function(t){var e="image/jpeg"===t.type,n=t.size/1024/1024<2;return e||this.$message.error("上传头像图片只能是 JPG 格式!"),n||this.$message.error("上传头像图片大小不能超过 2MB!"),e&&n}}},u=s,d=(n("9e33"),n("2877")),m=Object(d["a"])(u,r,o,!1,null,"a62ae8ec",null);e["default"]=m.exports},dd1f:function(t,e,n){}}]);